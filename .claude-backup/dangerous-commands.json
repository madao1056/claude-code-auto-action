{
  "description": "危険なコマンドと料金発生コマンドのリスト",
  "categories": {
    "deletion": {
      "description": "データやファイルを削除するコマンド",
      "patterns": [
        "rm -rf",
        "rm -r",
        "rm -f",
        "rm /*",
        "sudo rm",
        "del /f",
        "del /s",
        "format",
        "fdisk",
        "dd if=/dev/zero",
        "dd of=/dev/",
        "shred",
        "wipe",
        "secure-delete",
        "> /dev/sda",
        "mkfs",
        "parted",
        "diskutil erase"
      ]
    },
    "package_removal": {
      "description": "パッケージやソフトウェアを削除するコマンド",
      "patterns": [
        "apt-get purge",
        "apt-get remove",
        "apt remove",
        "yum remove",
        "dnf remove",
        "pacman -R",
        "brew uninstall",
        "brew remove",
        "npm uninstall -g",
        "npm remove -g",
        "yarn global remove",
        "pip uninstall",
        "pip3 uninstall",
        "gem uninstall",
        "cargo uninstall",
        "composer global remove"
      ]
    },
    "cloud_deletion": {
      "description": "クラウドリソースを削除するコマンド",
      "patterns": [
        "aws s3 rm",
        "aws s3 rb",
        "aws ec2 terminate",
        "aws rds delete",
        "aws cloudformation delete",
        "gcloud compute instances delete",
        "gcloud sql instances delete",
        "gcloud app services delete",
        "az vm delete",
        "az group delete",
        "az storage account delete",
        "terraform destroy",
        "terraform state rm",
        "kubectl delete",
        "helm delete",
        "helm uninstall",
        "docker rm -f",
        "docker rmi -f",
        "docker system prune -a",
        "docker volume prune",
        "heroku apps:destroy",
        "heroku addons:destroy",
        "vercel remove",
        "netlify sites:delete"
      ]
    },
    "database_deletion": {
      "description": "データベースを削除・破壊するコマンド",
      "patterns": [
        "DROP DATABASE",
        "DROP TABLE",
        "DROP SCHEMA",
        "TRUNCATE",
        "DELETE FROM",
        "dropdb",
        "mongo --eval.*drop",
        "redis-cli FLUSHALL",
        "redis-cli FLUSHDB",
        "psql.*DROP",
        "mysql.*DROP",
        "influx -execute.*DROP"
      ]
    },
    "billing_services": {
      "description": "料金が発生するサービスの作成・アップグレード",
      "patterns": [
        "stripe",
        "paypal",
        "square",
        "braintree",
        "aws.*create",
        "aws.*run-instances",
        "aws.*modify.*instance",
        "gcloud.*create",
        "gcloud compute instances create",
        "gcloud sql instances create",
        "az.*create",
        "az vm create",
        "terraform apply",
        "pulumi up",
        "heroku addons:create",
        "heroku dyno:resize",
        "vercel --prod",
        "netlify deploy --prod",
        "firebase deploy",
        "amplify push",
        "serverless deploy",
        "sam deploy",
        "eb deploy",
        "gcloud app deploy",
        "kubectl apply.*replicas",
        "docker-compose up -d.*scale"
      ]
    },
    "subscription_upgrades": {
      "description": "サブスクリプションや料金プランのアップグレード",
      "patterns": [
        "npm install.*--save-exact.*@latest",
        "yarn upgrade",
        "composer require.*:@stable",
        "bundler update",
        "github.*billing",
        "gitlab.*subscription",
        "datadog.*usage",
        "newrelic.*subscription",
        "sentry.*quota",
        "mongodb.*atlas.*tier",
        "elasticsearch.*billing",
        "redis.*plan",
        "cloudflare.*plan",
        "twilio.*upgrade",
        "sendgrid.*plan",
        "auth0.*subscription"
      ]
    },
    "api_calls_with_cost": {
      "description": "料金が発生するAPI呼び出し",
      "patterns": [
        "openai",
        "anthropic",
        "gpt-4",
        "gpt-3.5",
        "dall-e",
        "whisper api",
        "stability-ai",
        "midjourney",
        "huggingface.*inference",
        "google.*translate.*api",
        "google.*vision.*api",
        "aws.*textract",
        "aws.*rekognition",
        "azure.*cognitive",
        "twilio.*send",
        "sendgrid.*send",
        "mailgun.*send",
        "vonage.*sms",
        "pusher.*trigger",
        "firebase.*messaging.*send"
      ]
    },
    "system_modification": {
      "description": "システムファイルを変更する危険なコマンド",
      "patterns": [
        "chmod -R 777",
        "chmod 777 /",
        "chown -R",
        "chown root",
        "sudo passwd",
        "usermod -aG sudo",
        "visudo",
        "/etc/passwd",
        "/etc/shadow",
        "/etc/sudoers",
        "systemctl disable",
        "systemctl mask",
        "service.*stop",
        "kill -9",
        "killall",
        "shutdown",
        "reboot",
        "init 0",
        "init 6"
      ]
    }
  },
  "whitelist": {
    "description": "安全と判断される例外パターン",
    "patterns": [
      "rm -rf node_modules",
      "rm -rf dist",
      "rm -rf build",
      "rm -rf .cache",
      "rm -rf coverage",
      "rm -rf tmp",
      "rm -rf temp",
      "git rm",
      "npm test",
      "npm run test",
      "yarn test",
      "docker rm",
      "docker rmi"
    ]
  }
}
